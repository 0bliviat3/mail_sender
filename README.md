# 대량 맞춤 메일 발송 프로그램

## 기능 소개
- 여러 사람에게 개별 맞춤 메일을 자동으로 발송
- Excel/CSV로 수신자 정보 관리
- 각 수신자별로 다른 첨부파일 지원
- 메일 템플릿에서 이름 자동 치환
- 사용자 친화적인 GUI 인터페이스
- 테스트 모드로 안전하게 미리 확인

## 설치 방법

### 1. Python 설치
- Python 3.8 이상 필요
- https://www.python.org/downloads/ 에서 다운로드

### 2. 필요한 패키지 설치
```bash
pip install -r requirements.txt
```

또는 개별 설치:
```bash
pip install pandas openpyxl
```

### 3. 프로그램 실행
```bash
python email_sender.py
```

## 사용 방법

### 1단계: 발신자 설정

#### Gmail 사용 시
1. Gmail 계정에서 **2단계 인증** 활성화
   - Google 계정 관리 → 보안 → 2단계 인증

2. **앱 비밀번호** 생성
   - Google 계정 관리 → 보안 → 앱 비밀번호
   - 앱: 메일 선택
   - 기기: Windows 컴퓨터 선택
   - 생성된 16자리 비밀번호 복사

3. 프로그램에 입력
   - 발신 이메일: 본인의 Gmail 주소
   - 비밀번호: 앱 비밀번호 (일반 비밀번호 아님!)
   - SMTP 서버: smtp.gmail.com
   - 포트: 587

#### 다른 메일 서비스
- **Naver**: smtp.naver.com, 포트 587
- **Daum**: smtp.daum.net, 포트 465
- **Outlook**: smtp-mail.outlook.com, 포트 587

### 2단계: 수신자 데이터 준비

#### Excel 파일 형식
| 이메일 | 이름 | 첨부파일 |
|--------|------|----------|
| user1@example.com | 홍길동 | C:/files/doc1.pdf |
| user2@example.com | 김철수 | |
| user3@example.com | 이영희 | C:/files/doc2.pdf |

- **필수 컬럼**: 이메일, 이름
- **선택 컬럼**: 첨부파일 (파일 경로)
- 첨부파일이 없는 경우 빈칸으로 둠

#### 샘플 파일 생성
프로그램에서 "📝 샘플 파일 생성" 버튼을 클릭하여 예제 파일을 만들 수 있습니다.

### 3단계: 메일 내용 작성

1. **메일 제목** 입력
2. **메일 본문 템플릿** 작성
   - `{{이름}}`을 사용하면 각 수신자의 이름으로 자동 치환됩니다

**예시:**
```
안녕하세요, {{이름}}님

2024년도 연말 정산 안내드립니다.
첨부파일을 확인해주시기 바랍니다.

감사합니다.
```

**결과:**
```
안녕하세요, 홍길동님
...

안녕하세요, 김철수님
...
```

### 4단계: 전송 옵션 설정

- **첨부파일 사용**: Excel 파일에 '첨부파일' 컬럼이 있고 첨부할 경우 체크
- **테스트 모드**: 처음 사용 시 반드시 체크하여 테스트 (실제 전송 안됨)

### 5단계: 메일 전송

1. **테스트 모드**로 먼저 실행
   - 전송 로그 확인
   - 데이터가 올바른지 검증

2. 문제없으면 **테스트 모드 해제**하고 실제 전송

## 주의사항

### 전송 제한
- **Gmail**: 하루 약 500통 제한
- **Naver**: 하루 약 300통 제한
- 대량 발송 시 여러 날에 걸쳐 분할 전송 권장

### 보안
- 비밀번호는 프로그램에 저장되지 않습니다
- Gmail은 반드시 **앱 비밀번호** 사용
- 일반 비밀번호로는 작동하지 않습니다

### 스팸 방지
- 한 번에 너무 많은 메일을 보내면 스팸으로 분류될 수 있음
- 적절한 간격을 두고 분할 전송 권장
- 메일 내용을 명확하고 정중하게 작성

### 첨부파일
- 파일 경로는 절대 경로 사용 권장
  - 좋은 예: `C:/Users/사용자/Documents/파일.pdf`
  - 나쁜 예: `../파일.pdf`
- 파일이 존재하지 않으면 첨부되지 않고 넘어감
- 너무 큰 파일(10MB 이상)은 전송 실패할 수 있음

## 문제 해결

### "SMTP 인증 실패" 오류
- Gmail 앱 비밀번호를 사용했는지 확인
- 2단계 인증이 활성화되어 있는지 확인
- SMTP 서버 주소와 포트 번호 확인

### "연결 거부" 오류
- 인터넷 연결 확인
- 방화벽에서 프로그램 차단 여부 확인
- 포트 587 또는 465로 변경해보기

### 한글 깨짐 현상
- Excel 파일을 UTF-8 형식으로 저장
- CSV는 "UTF-8 BOM" 인코딩으로 저장

### 첨부파일이 전송되지 않음
- "첨부파일 사용" 체크박스 확인
- Excel의 '첨부파일' 컬럼명 정확히 입력
- 파일 경로가 올바른지 확인
- 파일이 실제로 존재하는지 확인

## 고급 사용법

### 여러 변수 사용하기
Excel에 컬럼을 추가하고 본문에 `{{컬럼명}}`으로 사용 가능
(현재 버전은 이름만 지원, 코드 수정 필요)

### 대량 발송 분할
Excel 파일을 여러 개로 나누어 하루에 걸쳐 전송

### HTML 메일
현재는 일반 텍스트만 지원
(HTML 메일 기능은 코드 수정으로 추가 가능)

## 라이선스
MIT License
이 프로그램은 개인 및 상업적 용도로 자유롭게 사용 가능합니다.

## 지원
문제가 발생하면 전송 로그를 확인하고,
필요시 개발자에게 로그와 함께 문의하세요.
